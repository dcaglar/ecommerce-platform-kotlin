# 🗂️ Folder Structure — `ecommerce-platform-kotlin`

This document provides a concise overview of the project’s multi-module structure, showing how each component fits into the payment, ledger, and observability pipeline.

---

```bash
ecommerce-platform-kotlin/
├── charts/                               # 🧭 Helm charts for Kubernetes deployment
│   ├── payment-service/                  # Helm chart for REST API deployable
│   ├── payment-consumers/                # Helm chart for Kafka worker deployable
│   └── payment-platform-config/          # Shared config, secrets, and values
│
├── common/                               # 🔁 Shared contracts and utilities
│   ├── src/main/kotlin/com/dogancaglar/common/
│   │   ├── event/                        # EventEnvelope, topics, group constants
│   │   ├── logging/                      # LogContext, MDC helpers
│   │   └── tracing/                      # TraceId, ParentEventId propagation
│   └── pom.xml
│
├── docs/                                 # 📚 Documentation and architecture references
│   ├── architecture.md                   # Full system overview (payment + ledger)
│   ├── how-to-start.md                   # Local setup and minikube deployment
│   ├── folder-structure.md               # (this file)
│   └── cheatsheets.md                    # Troubleshooting, common commands
│
├── infra/                                # 🧱 Local infrastructure setup & scripts
│   ├── helm-values/                      # Helm value overrides for local/CI/CD
│   ├── keycloak/                         # Keycloak realm + client provisioning scripts
│   │   ├── provision-keycloak.sh
│   │   ├── get-token.sh
│   │   └── output/
│   ├── scripts/                          # Helper scripts for infra bootstrapping
│   │   ├── bootstrap-minikube-cluster.sh # Start Minikube profile + metrics-server
│   │   ├── deploy-all-local.sh           # Deploy core stack (DB, Redis, Kafka, Keycloak)
│   │   ├── deploy-monitoring-stack.sh    # Prometheus + Grafana (kube-prometheus-stack)
│   │   ├── deploy-kafka-exporter-local.sh# Kafka lag metrics for Prometheus
│   │   ├── deploy-payment-service-local.sh# Deploy REST API service
│   │   ├── deploy-payment-consumers-local.sh# Deploy Kafka worker consumers
│   │   ├── add-consumer-lag-metric.sh    # Prometheus adapter for lag-based HPA
│   │   ├── port-forwarding.sh            # Port-forward Keycloak, Grafana, Prometheus, DB
│   │   └── deploy-observability-stack.sh # ELK (Elasticsearch + Logstash + Kibana)
│   └── endpoints.json                    # Generated by deploy scripts (Ingress host info)
│
├── load-tests/                           # ⚙️ k6 load test scripts for throughput validation
│   └── baseline-smoke-test.js
│
├── payment-domain/                       # 💡 Core domain logic (pure Kotlin, no frameworks)
│   ├── src/main/kotlin/com/dogancaglar/paymentservice/domain/
│   │   ├── model/                        # Aggregates, Value Objects (Payment, PaymentOrder)
│   │   ├── event/                        # Domain events (PaymentCreated, PaymentSucceeded)
│   │   ├── port/                         # Ports (Repository, EventPublisher, LedgerPort)
│   │   ├── exception/                    # Domain exceptions
│   │   └── ledger/                       # Double-entry accounting domain (JournalEntry, Posting)
│   └── pom.xml
│
├── payment-application/                  # 🧠 Application layer (use cases, orchestration)
│   ├── src/main/kotlin/com/dogancaglar/paymentservice/application/
│   │   ├── usecases/                     # RecordLedgerEntriesService, ProcessPaymentService
│   │   ├── schedulers/                   # OutboxDispatcherJob, RetryDispatcherScheduler
│   │   └── workflow/                     # Payment orchestration logic
│   └── pom.xml
│
├── payment-infrastructure/               # 🧩 Adapters & auto-configuration
│   ├── src/main/kotlin/com/dogancaglar/paymentservice/adapter/outbound
│   │   ├── persistence/                  # JPA & MyBatis repositories
│   │   ├── kafka/                        # Kafka producers, transactional templates
│   │   ├── redis/                        # Redis-based retry and ID generator
│   │   ├── psp/                          # PSP client simulation
│   │   └── ledger/                       # LedgerPersistenceMapper, MyBatis mappers
│   └── pom.xml
│
├── payment-service/                      # 🌐 REST API for initiating payments
│   ├── src/main/kotlin/com/dogancaglar/paymentservice/
│   │   ├── adapter/inbound/rest/         # Controllers and DTOs
│   │   ├── config/                       # Spring config (security, beans)
│   │   └── scheduler/                    # OutboxDispatcher job beans
│   └── pom.xml
│
├── payment-consumers/                    # ⚙️ Async processing (Kafka-driven)
│   ├── src/main/kotlin/com/dogancaglar/paymentservice/port/inbound/consumers/
│   │   ├── PaymentOrderEnqueuer.kt       # Consumes PaymentOrderCreated → PSP call request
│   │   ├── PaymentOrderPspCallExecutor.kt# Performs PSP calls (mocked latency)
│   │   ├── PaymentOrderPspResultApplier.kt# Applies PSP results & publishes next events
│   │   ├── LedgerRecordingConsumer.kt    # Creates double-entry journals
│   │   ├── AccountBalanceConsumer.kt     # Aggregates balances from ledger entries
│   │   └── base/                         # Abstract consumer base classes
│   └── pom.xml
│
├── tests/                                # 🧪 Optional test resources (integration suites)
│   └── resources/
│
├── pom.xml                               # Maven parent POM (manages all modules)
├── README.md                             # Project overview and diagrams
└── LICENSE                               # License file (if applicable)