<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                            http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.3.xsd">

    <!-- =============================================================
         Fix: convert claimed_at from TIMESTAMPTZ → TIMESTAMP
         Context: Liquibase 4.3, PostgreSQL
         Reason: MyBatis LocalDateTime cannot map TIMESTAMPTZ
         ============================================================= -->
    <changeSet id="20251112-fix-claimed-at-type" author="dogancaglar">

        <!-- 1️⃣ Modify column type safely -->
        <modifyDataType
                tableName="outbox_event"
                columnName="claimed_at"
                newDataType="TIMESTAMP"/>

        <!-- 2️⃣ Add comment for schema clarity -->
        <sql>
            COMMENT ON COLUMN outbox_event.claimed_at IS 'Changed from TIMESTAMPTZ to TIMESTAMP for Kotlin LocalDateTime compatibility';
        </sql>

    </changeSet>

</databaseChangeLog>